Set-ItemProperty -Path $registryPath -Name $propertyName -Value $propertyValue
$global:isDarkMode = $False


function Toggle-Theme {
    
    if ($global:isDarkMode)
    {
        Switch-ToLightMode
    } 
    else
    {
        Switch-ToDarkMode
    }
    
    $global:isDarkMode = -not $global:isDarkMode
}

# Function to switch to dark mode
function Switch-ToDarkMode {

    try {

        $window.FindName('themeText').Header = "Light mode"
        $theme = $window.FindResource("DarkTheme")
        $window.Resources.MergedDictionaries.Clear()
        $window.Resources.MergedDictionaries.Add($theme)
        Set-ItemProperty -Path "HKCU:\Software\ITTEmadadel" -Name "Theme" -Value "Dark" -Force

    } catch {
        Write-Host "Error: $_"
    }
}

# Function to switch to light mode
function Switch-ToLightMode {

    try {
       
        $window.FindName('themeText').Header = "Dark mode"
        $theme = $window.FindResource("LightTheme")
        $window.Resources.MergedDictionaries.Clear()
        $window.Resources.MergedDictionaries.Add($theme)
        Set-ItemProperty -Path "HKCU:\Software\ITTEmadadel" -Name "Theme" -Value "Light"

    } catch {
        Write-Host "Error: $_"
    }
}


